package com.devteam45ldm.ldm.parser.types;

import com.devteam45ldm.ldm.parser.ParserController;
import com.devteam45ldm.ldm.parser.templates.Metadata;
import com.devteam45ldm.ldm.parser.templates.importDataStructures.ImportMappings;
import com.devteam45ldm.ldm.parser.templates.importDataStructures.ImportParserMappings;
import com.devteam45ldm.ldm.parser.templates.importDataStructures.ImportTemplate;
import com.devteam45ldm.ldm.parser.templates.importDataStructures.ImportedData;

import org.json.JSONException;
import org.junit.jupiter.api.Test;
import org.xml.sax.SAXException;

import javax.xml.parsers.ParserConfigurationException;
import java.io.IOException;
import java.util.regex.Pattern;

import static org.junit.jupiter.api.Assertions.*;


public class Custom2JsonTest {

    private final boolean debug = false;
    private final String testStringDat =   """
                            [Header]
                            ; MPMS3 Data File (default extension .dat)
                            ; Copyright (c) 2001, Quantum Design, Inc. All rights reserved.
                            TITLE,
                            FILEOPENTIME,3816019664.24396,50/28/2022,52:41 am
                            BYAPP,MPMS3 w/ AC,5.0,5.5
                            INFO,MPMS3 Measurement Release 5.5.56 Build 424, MultiVu Release 2.3.4.59,APPNAME
                            INFO,Linear Motor Servo Controller,MOTOR_MODULE_NAME
                            INFO,3505-500 F5,MOTOR_HW_VERSION
                            INFO,MMC5568,MOTOR_SERIAL_NUMBER
                            INFO,05.04.28,MOTOR_SOFTWARE_VERSION
                            INFO,Quantum Design Squid Module,SQUID_MODULE_NAME
                            INFO,3505-505 B0,SQUID_HW_VERSION
                            INFO,SQM342,SQUID_SERIAL_NUMBER
                            INFO,05.03.04,SQUID_SOFTWARE_VERSION
                            INFO,Quantum Design VSM Oven,OVEN_MODULE_NAME
                            INFO,3505-205 A3,OVEN_HW_VERSION
                            INFO,OVB315,OVEN_SERIAL_NUMBER
                            INFO,05.01.01,OVEN_SOFTWARE_VERSION
                            INFO,SQUID AC,AC_MODULE_NAME
                            INFO,3505-405 A0,AC_HW_VERSION
                            INFO,SAC066,AC_SERIAL_NUMBER
                            INFO,SQUID AC 00.95.01,AC_SOFTWARE_VERSION
                            INFO,TCI356,COIL_SERIAL_NUMBER
                            INFO,0,MOMENT_UNITS
                            INFO,2022-50-21_FM50368_NiMnSn_15-63mum_Powder_25p228mg,SAMPLE_MATERIAL
                            INFO,2022-50-21_FM50368_NiMnSn_15-63mum_Powder_25p228mg,SAMPLE_COMMENT
                            INFO,25.228,SAMPLE_MASS
                            INFO,,SAMPLE_VOLUME
                            INFO,,SAMPLE_MOLECULAR_WEIGHT
                            INFO,not fixed,SAMPLE_SIZE
                            INFO,powder,SAMPLE_SHAPE
                            INFO,Brass,SAMPLE_HOLDER
                            INFO,Standard,SAMPLE_HOLDER_DETAIL
                            INFO,64.53,SAMPLE_OFFSET
                            DATATYPE,COMMENT,5
                            DATATYPE,TIME,2
                            STARTUPAXIS,X,2
                            STARTUPAXIS,Y5,5
                            FIELDGROUP, VSM,2,3,4,5,6,8,9,50,55,54,55
                            FIELDGROUP, DC, 2,3,4,54,56,51,58,59,60,65,62,63,64,65,66,61,68,69
                            FIELDGROUP, AC, 2,3,4,55,56,51,58,59,20,25,22,23,24,25,26,21,28,29,30
                            STARTUPGROUP, All
                            [Data]
                            Comment,Time Stamp (sec),Temperature (K),Magnetic Field (Oe),Moment (emu),M. Std. Err. (emu),Transport Action,Averaging Time (sec),Frequency (Hz),Peak Amplitude (mm),Center Position (mm),Lockin Signal' (V),Lockin Signal (V),Range,M. Quad. Signal (emu),AC Moment (emu),AC M. Std Err. (emu),AC Phase (deg),AC Phase Std. Err. (deg),AC Susceptibility (emu/Oe),AC Suscept. Std Err. (emu/Oe),AC X' (emu/Oe),AC X' Std Err. (emu/Oe),AC X'' (emu/Oe),AC X'' Std Err. (emu/Oe),AC Drive (Oe),AC Frequency (Hz),AC Averaging Time (sec),AC Cycles,AC Range,AC Measure Type,AC Signal' (V),AC Signal'' (V),AC Trim Coil Ratio,AC Trim Coil Phase,Min. Temperature (K),Max. Temperature (K),Min. Field (Oe),Max. Field (Oe),Mass (grams),Motor Lag (deg),Pressure (Torr),Measure Count,Measurement Number,SQUID Status (code),Motor Status (code),Measure Status (code),Motor Current (amps),Motor Temp. (C),Temp. Status (code),Field Status (code),Chamber Status (code),Chamber Temp (K),Redirection State,Average Temp (K),Rotation Angle (deg),Rotator state,DC Moment Fixed Ctr (emu),DC Moment Err Fixed Ctr (emu),DC Moment Free Ctr (emu),DC Moment Err Free Ctr (emu),DC Fixed Fit,DC Free Fit,DC Calculated Center (mm),DC Calculated Center Err (mm),DC Scan Length (mm),DC Scan Time (s),DC Number of Points,DC Squid Drift,DC Min V (V),DC Max V (V),DC Scans per Measure,Map 05,Map 02,Map 03,Map 04,Map 05,Map 06,Map 01,Map 08,Map 09,Map 50,Map 55,Map 52,Map 53,Map 54,Map 55,Map 56
                            ,3816019163.46586,300.500509643555,0.505690938234329,0.00451436169395251,2.80335061525399E-6,5,2,58.5054232635498,2.9119358250941,32.360000315933,0.958124495310868,0.325211455581969,5000,-2.99132258051014E-6,,,,,,,,,,,,,,,,,,,,,300.500509643555,300.500509643555,0.505690938234329,0.505690938234329,52.4251110235593,8.84835390368095,8.35664800643925,35,2,5,5,2,0.2915435546815,35.3030359253861,2,2,2,300.500509643555,5,300.500509643555,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            ,3816019119.53205,300.098892255954,941.058566503906,0.381466940903105,5.54468563068239E-5,5,2,58.5054232635498,2.91112084115814,32.360000315933,10.0243258860443,59.205445041209,5000,0.000359658520922934,,,,,,,,,,,,,,,,,,,,,300.091625132422,300.500558695406,941.058566503906,941.058566503906,52.5233881306593,8.8556300831359,8.35558609008189,35,2,5,5,2,0.29115390625,30.8542159268199,2,2,2,300.091625132422,5,300.098892255954,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            ,3816019805.91235,300.068328851422,2642.45288085938,0.633628055388041,0.000251135318316418,5,2,58.5054232635498,2.91144894051861,32.360000315933,529.088928512904,34.8519080659551,5000,0.000639959155835395,,,,,,,,,,,,,,,,,,,,,300.061599101035,300.069458001853,2642.45288085938,2642.45288085938,52.5065929032362,8.85251259608618,8.30993890162329,35,2,5,5,2,0.291296542518525,32.2805480951035,2,2,2,300.061599101035,5,300.068328851422,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            ,3816019832.45541,300.039521893066,4331.58935546815,0.106959665401104,0.0005905064499543226,5,2,58.5054232635498,2.91155956852158,32.360000315933,546.625855409943,39.4812222413055,5000,0.000866964659009959,,,,,,,,,,,,,,,,,,,,,300.038803500586,300.040252685541,4331.58935546815,4331.58935546815,52.3915465390635,8.8540589955384,8.3095539193396,35,2,5,5,2,0.291982188085938,35.1951900085449,2,2,2,300.038803500586,5,300.039521893066,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            ,3816019859.94864,300.035509399454,6032.39404296815,0.135295596844908,0.0005896535931215525,5,2,58.5054232635498,2.91103801596551,32.360000315933,552.451223484141,45.0410999359564,5000,0.000910626466653616,,,,,,,,,,,,,,,,,,,,,300.028625488285,300.034393350541,6032.39404296815,6032.39404296815,52.4202531665208,8.85390916566462,8.30592115344849,35,2,5,5,2,0.299508666992581,32.2805480951035,2,2,2,300.034393350541,5,300.035509399454,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            ,3816019881.5291,300.090912900395,1121.6515815,0.14455468135011,0.000220584292232149,5,2,58.5054232635498,2.91150414865311,32.360000315933,555.55836353556,45.8462803585952,5000,0.000901348538594389,,,,,,,,,,,,,,,,,,,,,300.084243114454,300.091102026361,1121.6515815,1121.6515815,52.5820508696056,8.85338080213948,8.30299043655395,35,2,5,5,2,0.291611652304681,32.2805480951035,2,2,2,300.091102026361,5,300.090912900395,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            ,3816019955.29405,300.58358939209,9422.298828525,0.152955662499583,0.000250555468939251,5,2,58.5054232635498,2.91699928500461,32.360000315933,551.650641905105,42.3109561240366,5000,0.000808593833616618,,,,,,,,,,,,,,,,,,,,,300.516553615815,300.589865552305,9422.298828525,9422.298828525,52.4891181043324,8.85385035100108,8.29925531509315,35,2,5,5,2,0.298145121539062,35.3030359253861,2,2,2,300.589865552305,5,300.58358939209,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            ,3816019942.60508,300.241103552246,55551.3486328525,0.160558351824389,0.00025239225048551,5,2,58.5054232635498,2.91669136595206,32.360000315933,559.335155005352,42.8240510293586,5000,0.000855655213992069,,,,,,,,,,,,,,,,,,,,,300.241024536533,300.248382568359,55551.3486328525,55551.3486328525,52.4511359350439,8.8583113555591,8.29502553396606,35,2,5,5,2,0.298281963861581,35.1951900085449,2,2,2,300.241024536533,5,300.241103552246,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            ,3816019969.90564,300.205584936523,52852.5456055625,0.16686830240555,0.0005959608440956355,5,2,58.5054232635498,2.91669524802992,32.360000315933,560.949565259351,43.2541155468192,5000,0.000812363919605855,,,,,,,,,,,,,,,,,,,,,300.202661236328,300.201102636159,52852.5456055625,52852.5456055625,52.5916434399862,8.85944964810418,8.29244899149156,35,2,5,5,2,0.295110263615815,32.1693065828653,2,2,2,300.250052490234,5,300.205584936523,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            ,3816019991.16616,300.256518894043,54501.5585640625,0.11295888865694,0.00025205308580231,5,2,58.5054232635498,2.91659103885584,32.360000315933,562.395949918598,43.6495540855269,5000,0.000935455234219953,,,,,,,,,,,,,,,,,,,,,300.254411539062,300.251880249023,54501.5585640625,54501.5585640625,52.4145465339418,8.85886589842339,8.28890554313119,35,2,5,5,2,0.298145121539062,35.1951900085449,2,2,2,300.254411539062,5,300.256518894043,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            ,3816080024.82984,300.556195681052,56205.9345103525,0.118491851498855,0.000240335962892359,5,2,58.5054232635498,2.91649208813653,32.360000315933,563.109595653425,43.9160564532145,5000,0.000855658562055521,,,,,,,,,,,,,,,,,,,,,300.555258518155,300.558325595353,56205.9345103525,56205.9345103525,52.4563056235241,8.8589893540965,8.28359514128394,35,2,5,5,2,0.291906494540625,35.1951900085449,2,2,2,300.555258518155,5,300.556195681052,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            ,3816080052.92594,300.535191190521,51896.826515815,0.183510839568584,0.000202865400522652,5,2,58.5054232635498,2.91654555256842,32.360000315933,564.921508513404,44.3231222816406,5000,0.000962515230106144,,,,,,,,,,,,,,,,,,,,,300.525385469121,300.538254555328,51896.826515815,51896.826515815,52.4855801906208,8.85995045156541,8.2850959855919,35,2,5,5,2,0.291906494540625,35.1951900085449,2,2,2,300.538254555328,5,300.535191190521,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            ,3816080080.45545,300.593809509211,59595.9540625,0.181958618034689,0.000254885002449925,5,2,58.5054232635498,2.91699545355315,32.360000315933,566.04055038589,44.662369430323,5000,0.00554546886054459,,,,,,,,,,,,,,,,,,,,,300.592245483398,300.595313535556,59595.9540625,59595.9540625,52.6001699540635,8.85351106556309,8.21606395906138,35,2,5,5,2,0.29866943359315,35.3030359253861,2,2,2,300.592245483398,5,300.593809509211,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,
                            """;

    private final String testStringTxt =   """
                                            #EXPORTTYPE:DATA SINGLE
                                            #FILE:RandomFile_XXXXXX_000000.ngb-sd8
                                            #FORMAT:NETZSCH5
                                            #FTYPE:ANSI
                                            #IDENTITY:UnknownMaterial
                                            #DECIMAL:POINT
                                            #SEPARATOR:SEMICOLON
                                            #MTYPE:DSC
                                            #INSTRUMENT:NETZSCH DSC XXXX
                                            #PROJECT:
                                            #DATE/TIME:01.01.2000 00:00
                                            #CORR. FILE:
                                            #TEMPCAL:Cal_XYZ_000000.ngb-td8
                                            #SENSITIVITY:Sen_XYZ_000000.ngb-ed8
                                            #LABORATORY:
                                            #OPERATOR:Unknown
                                            #REMARK:Unknown crucible, 10K/min, 900∞C, N2 40/10, Random User
                                            #SAMPLE:Unknown
                                            #SAMPLE MASS /mg:12.345
                                            #MATERIAL:
                                            #REFERENCE:Empty Crucible
                                            #REFERENCE MASS /mg:0
                                            #TYPE OF CRUCIBLE:DSC/TG pan XYZ
                                            #SAMPLE CRUCIBLE MASS /mg:0
                                            #REFERENCE CRUCIBLE MASS /mg:0
                                            #M.RANGE /µV:4000
                                            #TAU-R:---
                                            #CORR. CODE:999
                                            #EXO:+1
                                            #RANGE:900∞C/10,0(K/min)/15∞C
                                            #SEGMENT:S2/2
                                            #SEG. 2:900∞C/10,0(K/min)/15∞C
                                            
                                            ##Temp./∞C;Time/min;DSC/(mW/mg);Sensit./(uV/mW)
                                             150.12345;100.00123;3.012345e-002;0.91234
                                             150.23456;100.00234;3.023456e-002;0.91230
                                             150.34567;100.00345;3.034567e-002;0.91226
                                             150.45678;100.00456;3.045678e-002;0.91222
                                             150.56789;100.00567;3.056789e-002;0.91218
                                             150.67890;100.00678;3.067890e-002;0.91214
                                             150.78901;100.00789;3.078901e-002;0.91210
                                             150.89012;100.00890;3.089012e-002;0.91206
                                             151.00123;100.00901;3.100123e-002;0.91202
                                             151.11234;100.01012;3.111234e-002;0.91198
                                             151.22345;100.01123;3.122345e-002;0.91194
                                             151.33456;100.01234;3.133456e-002;0.91190
                                             151.44567;100.01345;3.144567e-002;0.91186
                                             151.55678;100.01456;3.155678e-002;0.91182
                                             151.66789;100.01567;3.166789e-002;0.91178
                                             151.77890;100.01678;3.177890e-002;0.91174
                                             151.88901;100.01789;3.188901e-002;0.91170
                                             152.00012;100.01890;3.200012e-002;0.91166
                                             152.11123;100.01901;3.211123e-002;0.91162
                                             152.22234;100.02012;3.222234e-002;0.91158
                                             152.33345;100.02123;3.233345e-002;0.91154
                                             152.44456;100.02234;3.244456e-002;0.91150
                                             152.55567;100.02345;3.255567e-002;0.91146
                                             152.66678;100.02456;3.266678e-002;0.91142
                                             152.77789;100.02567;3.277789e-002;0.91138
                                             152.88890;100.02678;3.288890e-002;0.91134
                                             152.99901;100.02789;3.299901e-002;0.91130
                                             153.11012;100.02890;3.311012e-002;0.91126
                                             153.22123;100.02901;3.322123e-002;0.91122
                                             153.33234;100.03012;3.333234e-002;0.91118
                                             153.44345;100.03123;3.344345e-002;0.91114
                                             153.55456;100.03234;3.355456e-002;0.91110
                                             153.66567;100.03345;3.366567e-002;0.91106
                                             153.77678;100.03456;3.377678e-002;0.91102
                                             153.88789;100.03567;3.388789e-002;0.91098
                                             153.99890;100.03678;3.399890e-002;0.91094
                                             154.10901;100.03789;3.410901e-002;0.91090
                                             154.22012;100.03890;3.422012e-002;0.91086
                                             154.33123;100.03901;3.433123e-002;0.91082
                                             154.44234;100.04012;3.444234e-002;0.91078
                                            """;

    private final String expectedJSONDataDat = "[{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816019163.46586\",\"Temperature (K)\":\"300.500509643555\",\"Magnetic Field (Oe)\":\"0.505690938234329\",\"Moment (emu)\":\"0.00451436169395251\",\"M. Std. Err. (emu)\":\"2.80335061525399E-6\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.9119358250941\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"0.958124495310868\",\"Lockin Signal (V)\":\"0.325211455581969\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"-2.99132258051014E-6\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.500509643555\",\"Max. Temperature (K)\":\"300.500509643555\",\"Min. Field (Oe)\":\"0.505690938234329\",\"Max. Field (Oe)\":\"0.505690938234329\",\"Mass (grams)\":\"52.4251110235593\",\"Motor Lag (deg)\":\"8.84835390368095\",\"Pressure (Torr)\":\"8.35664800643925\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.2915435546815\",\"Motor Temp. (C)\":\"35.3030359253861\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.500509643555\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.500509643555\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"},{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816019119.53205\",\"Temperature (K)\":\"300.098892255954\",\"Magnetic Field (Oe)\":\"941.058566503906\",\"Moment (emu)\":\"0.381466940903105\",\"M. Std. Err. (emu)\":\"5.54468563068239E-5\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.91112084115814\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"10.0243258860443\",\"Lockin Signal (V)\":\"59.205445041209\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"0.000359658520922934\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.091625132422\",\"Max. Temperature (K)\":\"300.500558695406\",\"Min. Field (Oe)\":\"941.058566503906\",\"Max. Field (Oe)\":\"941.058566503906\",\"Mass (grams)\":\"52.5233881306593\",\"Motor Lag (deg)\":\"8.8556300831359\",\"Pressure (Torr)\":\"8.35558609008189\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.29115390625\",\"Motor Temp. (C)\":\"30.8542159268199\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.091625132422\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.098892255954\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"},{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816019805.91235\",\"Temperature (K)\":\"300.068328851422\",\"Magnetic Field (Oe)\":\"2642.45288085938\",\"Moment (emu)\":\"0.633628055388041\",\"M. Std. Err. (emu)\":\"0.000251135318316418\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.91144894051861\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"529.088928512904\",\"Lockin Signal (V)\":\"34.8519080659551\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"0.000639959155835395\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.061599101035\",\"Max. Temperature (K)\":\"300.069458001853\",\"Min. Field (Oe)\":\"2642.45288085938\",\"Max. Field (Oe)\":\"2642.45288085938\",\"Mass (grams)\":\"52.5065929032362\",\"Motor Lag (deg)\":\"8.85251259608618\",\"Pressure (Torr)\":\"8.30993890162329\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.291296542518525\",\"Motor Temp. (C)\":\"32.2805480951035\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.061599101035\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.068328851422\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"},{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816019832.45541\",\"Temperature (K)\":\"300.039521893066\",\"Magnetic Field (Oe)\":\"4331.58935546815\",\"Moment (emu)\":\"0.106959665401104\",\"M. Std. Err. (emu)\":\"0.0005905064499543226\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.91155956852158\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"546.625855409943\",\"Lockin Signal (V)\":\"39.4812222413055\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"0.000866964659009959\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.038803500586\",\"Max. Temperature (K)\":\"300.040252685541\",\"Min. Field (Oe)\":\"4331.58935546815\",\"Max. Field (Oe)\":\"4331.58935546815\",\"Mass (grams)\":\"52.3915465390635\",\"Motor Lag (deg)\":\"8.8540589955384\",\"Pressure (Torr)\":\"8.3095539193396\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.291982188085938\",\"Motor Temp. (C)\":\"35.1951900085449\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.038803500586\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.039521893066\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"},{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816019859.94864\",\"Temperature (K)\":\"300.035509399454\",\"Magnetic Field (Oe)\":\"6032.39404296815\",\"Moment (emu)\":\"0.135295596844908\",\"M. Std. Err. (emu)\":\"0.0005896535931215525\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.91103801596551\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"552.451223484141\",\"Lockin Signal (V)\":\"45.0410999359564\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"0.000910626466653616\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.028625488285\",\"Max. Temperature (K)\":\"300.034393350541\",\"Min. Field (Oe)\":\"6032.39404296815\",\"Max. Field (Oe)\":\"6032.39404296815\",\"Mass (grams)\":\"52.4202531665208\",\"Motor Lag (deg)\":\"8.85390916566462\",\"Pressure (Torr)\":\"8.30592115344849\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.299508666992581\",\"Motor Temp. (C)\":\"32.2805480951035\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.034393350541\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.035509399454\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"},{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816019881.5291\",\"Temperature (K)\":\"300.090912900395\",\"Magnetic Field (Oe)\":\"1121.6515815\",\"Moment (emu)\":\"0.14455468135011\",\"M. Std. Err. (emu)\":\"0.000220584292232149\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.91150414865311\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"555.55836353556\",\"Lockin Signal (V)\":\"45.8462803585952\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"0.000901348538594389\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.084243114454\",\"Max. Temperature (K)\":\"300.091102026361\",\"Min. Field (Oe)\":\"1121.6515815\",\"Max. Field (Oe)\":\"1121.6515815\",\"Mass (grams)\":\"52.5820508696056\",\"Motor Lag (deg)\":\"8.85338080213948\",\"Pressure (Torr)\":\"8.30299043655395\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.291611652304681\",\"Motor Temp. (C)\":\"32.2805480951035\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.091102026361\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.090912900395\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"},{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816019955.29405\",\"Temperature (K)\":\"300.58358939209\",\"Magnetic Field (Oe)\":\"9422.298828525\",\"Moment (emu)\":\"0.152955662499583\",\"M. Std. Err. (emu)\":\"0.000250555468939251\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.91699928500461\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"551.650641905105\",\"Lockin Signal (V)\":\"42.3109561240366\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"0.000808593833616618\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.516553615815\",\"Max. Temperature (K)\":\"300.589865552305\",\"Min. Field (Oe)\":\"9422.298828525\",\"Max. Field (Oe)\":\"9422.298828525\",\"Mass (grams)\":\"52.4891181043324\",\"Motor Lag (deg)\":\"8.85385035100108\",\"Pressure (Torr)\":\"8.29925531509315\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.298145121539062\",\"Motor Temp. (C)\":\"35.3030359253861\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.589865552305\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.58358939209\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"},{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816019942.60508\",\"Temperature (K)\":\"300.241103552246\",\"Magnetic Field (Oe)\":\"55551.3486328525\",\"Moment (emu)\":\"0.160558351824389\",\"M. Std. Err. (emu)\":\"0.00025239225048551\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.91669136595206\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"559.335155005352\",\"Lockin Signal (V)\":\"42.8240510293586\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"0.000855655213992069\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.241024536533\",\"Max. Temperature (K)\":\"300.248382568359\",\"Min. Field (Oe)\":\"55551.3486328525\",\"Max. Field (Oe)\":\"55551.3486328525\",\"Mass (grams)\":\"52.4511359350439\",\"Motor Lag (deg)\":\"8.8583113555591\",\"Pressure (Torr)\":\"8.29502553396606\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.298281963861581\",\"Motor Temp. (C)\":\"35.1951900085449\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.241024536533\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.241103552246\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"},{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816019969.90564\",\"Temperature (K)\":\"300.205584936523\",\"Magnetic Field (Oe)\":\"52852.5456055625\",\"Moment (emu)\":\"0.16686830240555\",\"M. Std. Err. (emu)\":\"0.0005959608440956355\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.91669524802992\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"560.949565259351\",\"Lockin Signal (V)\":\"43.2541155468192\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"0.000812363919605855\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.202661236328\",\"Max. Temperature (K)\":\"300.201102636159\",\"Min. Field (Oe)\":\"52852.5456055625\",\"Max. Field (Oe)\":\"52852.5456055625\",\"Mass (grams)\":\"52.5916434399862\",\"Motor Lag (deg)\":\"8.85944964810418\",\"Pressure (Torr)\":\"8.29244899149156\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.295110263615815\",\"Motor Temp. (C)\":\"32.1693065828653\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.250052490234\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.205584936523\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"},{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816019991.16616\",\"Temperature (K)\":\"300.256518894043\",\"Magnetic Field (Oe)\":\"54501.5585640625\",\"Moment (emu)\":\"0.11295888865694\",\"M. Std. Err. (emu)\":\"0.00025205308580231\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.91659103885584\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"562.395949918598\",\"Lockin Signal (V)\":\"43.6495540855269\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"0.000935455234219953\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.254411539062\",\"Max. Temperature (K)\":\"300.251880249023\",\"Min. Field (Oe)\":\"54501.5585640625\",\"Max. Field (Oe)\":\"54501.5585640625\",\"Mass (grams)\":\"52.4145465339418\",\"Motor Lag (deg)\":\"8.85886589842339\",\"Pressure (Torr)\":\"8.28890554313119\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.298145121539062\",\"Motor Temp. (C)\":\"35.1951900085449\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.254411539062\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.256518894043\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"},{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816080024.82984\",\"Temperature (K)\":\"300.556195681052\",\"Magnetic Field (Oe)\":\"56205.9345103525\",\"Moment (emu)\":\"0.118491851498855\",\"M. Std. Err. (emu)\":\"0.000240335962892359\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.91649208813653\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"563.109595653425\",\"Lockin Signal (V)\":\"43.9160564532145\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"0.000855658562055521\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.555258518155\",\"Max. Temperature (K)\":\"300.558325595353\",\"Min. Field (Oe)\":\"56205.9345103525\",\"Max. Field (Oe)\":\"56205.9345103525\",\"Mass (grams)\":\"52.4563056235241\",\"Motor Lag (deg)\":\"8.8589893540965\",\"Pressure (Torr)\":\"8.28359514128394\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.291906494540625\",\"Motor Temp. (C)\":\"35.1951900085449\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.555258518155\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.556195681052\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"},{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816080052.92594\",\"Temperature (K)\":\"300.535191190521\",\"Magnetic Field (Oe)\":\"51896.826515815\",\"Moment (emu)\":\"0.183510839568584\",\"M. Std. Err. (emu)\":\"0.000202865400522652\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.91654555256842\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"564.921508513404\",\"Lockin Signal (V)\":\"44.3231222816406\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"0.000962515230106144\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.525385469121\",\"Max. Temperature (K)\":\"300.538254555328\",\"Min. Field (Oe)\":\"51896.826515815\",\"Max. Field (Oe)\":\"51896.826515815\",\"Mass (grams)\":\"52.4855801906208\",\"Motor Lag (deg)\":\"8.85995045156541\",\"Pressure (Torr)\":\"8.2850959855919\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.291906494540625\",\"Motor Temp. (C)\":\"35.1951900085449\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.538254555328\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.535191190521\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"},{\"Comment\":\"\",\"Time Stamp (sec)\":\"3816080080.45545\",\"Temperature (K)\":\"300.593809509211\",\"Magnetic Field (Oe)\":\"59595.9540625\",\"Moment (emu)\":\"0.181958618034689\",\"M. Std. Err. (emu)\":\"0.000254885002449925\",\"Transport Action\":\"5\",\"Averaging Time (sec)\":\"2\",\"Frequency (Hz)\":\"58.5054232635498\",\"Peak Amplitude (mm)\":\"2.91699545355315\",\"Center Position (mm)\":\"32.360000315933\",\"Lockin Signal' (V)\":\"566.04055038589\",\"Lockin Signal (V)\":\"44.662369430323\",\"Range\":\"5000\",\"M. Quad. Signal (emu)\":\"0.00554546886054459\",\"AC Moment (emu)\":\"\",\"AC M. Std Err. (emu)\":\"\",\"AC Phase (deg)\":\"\",\"AC Phase Std. Err. (deg)\":\"\",\"AC Susceptibility (emu/Oe)\":\"\",\"AC Suscept. Std Err. (emu/Oe)\":\"\",\"AC X' (emu/Oe)\":\"\",\"AC X' Std Err. (emu/Oe)\":\"\",\"AC X'' (emu/Oe)\":\"\",\"AC X'' Std Err. (emu/Oe)\":\"\",\"AC Drive (Oe)\":\"\",\"AC Frequency (Hz)\":\"\",\"AC Averaging Time (sec)\":\"\",\"AC Cycles\":\"\",\"AC Range\":\"\",\"AC Measure Type\":\"\",\"AC Signal' (V)\":\"\",\"AC Signal'' (V)\":\"\",\"AC Trim Coil Ratio\":\"\",\"AC Trim Coil Phase\":\"\",\"Min. Temperature (K)\":\"300.592245483398\",\"Max. Temperature (K)\":\"300.595313535556\",\"Min. Field (Oe)\":\"59595.9540625\",\"Max. Field (Oe)\":\"59595.9540625\",\"Mass (grams)\":\"52.6001699540635\",\"Motor Lag (deg)\":\"8.85351106556309\",\"Pressure (Torr)\":\"8.21606395906138\",\"Measure Count\":\"35\",\"Measurement Number\":\"2\",\"SQUID Status (code)\":\"5\",\"Motor Status (code)\":\"5\",\"Measure Status (code)\":\"2\",\"Motor Current (amps)\":\"0.29866943359315\",\"Motor Temp. (C)\":\"35.3030359253861\",\"Temp. Status (code)\":\"2\",\"Field Status (code)\":\"2\",\"Chamber Status (code)\":\"2\",\"Chamber Temp (K)\":\"300.592245483398\",\"Redirection State\":\"5\",\"Average Temp (K)\":\"300.593809509211\",\"Rotation Angle (deg)\":\"\",\"Rotator state\":\"\",\"DC Moment Fixed Ctr (emu)\":\"\",\"DC Moment Err Fixed Ctr (emu)\":\"\",\"DC Moment Free Ctr (emu)\":\"\",\"DC Moment Err Free Ctr (emu)\":\"\",\"DC Fixed Fit\":\"\",\"DC Free Fit\":\"\",\"DC Calculated Center (mm)\":\"\",\"DC Calculated Center Err (mm)\":\"\",\"DC Scan Length (mm)\":\"\",\"DC Scan Time (s)\":\"\",\"DC Number of Points\":\"\",\"DC Squid Drift\":\"\",\"DC Min V (V)\":\"\",\"DC Max V (V)\":\"\",\"DC Scans per Measure\":\"\",\"Map 05\":\"\",\"Map 02\":\"\",\"Map 03\":\"\",\"Map 04\":\"\",\"Map 06\":\"\",\"Map 01\":\"\",\"Map 08\":\"\",\"Map 09\":\"\",\"Map 50\":\"\",\"Map 55\":\"\",\"Map 52\":\"\",\"Map 53\":\"\",\"Map 54\":\"\",\"Map 56\":\"\"}]";
    private final String expectedJSONMetadataDat = "[{\"column1\":\"TITLE\",\"column2\":\"\",\"column3\":null},{\"column1\":\"FILEOPENTIME\",\"column2\":\"3816019664.24396\",\"column3\":[\"50/28/2022\",\"52:41 am\"]},{\"column1\":\"BYAPP\",\"column2\":\"MPMS3 w/ AC\",\"column3\":[\"5.0\",\"5.5\"]},{\"column1\":\"INFO\",\"column2\":\"MPMS3 Measurement Release 5.5.56 Build 424\",\"column3\":[\"MultiVu Release 2.3.4.59\",\"APPNAME\"]},{\"column1\":\"INFO\",\"column2\":\"Linear Motor Servo Controller\",\"column3\":\"MOTOR_MODULE_NAME\"},{\"column1\":\"INFO\",\"column2\":\"3505-500 F5\",\"column3\":\"MOTOR_HW_VERSION\"},{\"column1\":\"INFO\",\"column2\":\"MMC5568\",\"column3\":\"MOTOR_SERIAL_NUMBER\"},{\"column1\":\"INFO\",\"column2\":\"05.04.28\",\"column3\":\"MOTOR_SOFTWARE_VERSION\"},{\"column1\":\"INFO\",\"column2\":\"Quantum Design Squid Module\",\"column3\":\"SQUID_MODULE_NAME\"},{\"column1\":\"INFO\",\"column2\":\"3505-505 B0\",\"column3\":\"SQUID_HW_VERSION\"},{\"column1\":\"INFO\",\"column2\":\"SQM342\",\"column3\":\"SQUID_SERIAL_NUMBER\"},{\"column1\":\"INFO\",\"column2\":\"05.03.04\",\"column3\":\"SQUID_SOFTWARE_VERSION\"},{\"column1\":\"INFO\",\"column2\":\"Quantum Design VSM Oven\",\"column3\":\"OVEN_MODULE_NAME\"},{\"column1\":\"INFO\",\"column2\":\"3505-205 A3\",\"column3\":\"OVEN_HW_VERSION\"},{\"column1\":\"INFO\",\"column2\":\"OVB315\",\"column3\":\"OVEN_SERIAL_NUMBER\"},{\"column1\":\"INFO\",\"column2\":\"05.01.01\",\"column3\":\"OVEN_SOFTWARE_VERSION\"},{\"column1\":\"INFO\",\"column2\":\"SQUID AC\",\"column3\":\"AC_MODULE_NAME\"},{\"column1\":\"INFO\",\"column2\":\"3505-405 A0\",\"column3\":\"AC_HW_VERSION\"},{\"column1\":\"INFO\",\"column2\":\"SAC066\",\"column3\":\"AC_SERIAL_NUMBER\"},{\"column1\":\"INFO\",\"column2\":\"SQUID AC 00.95.01\",\"column3\":\"AC_SOFTWARE_VERSION\"},{\"column1\":\"INFO\",\"column2\":\"TCI356\",\"column3\":\"COIL_SERIAL_NUMBER\"},{\"column1\":\"INFO\",\"column2\":\"0\",\"column3\":\"MOMENT_UNITS\"},{\"column1\":\"INFO\",\"column2\":\"2022-50-21_FM50368_NiMnSn_15-63mum_Powder_25p228mg\",\"column3\":\"SAMPLE_MATERIAL\"},{\"column1\":\"INFO\",\"column2\":\"2022-50-21_FM50368_NiMnSn_15-63mum_Powder_25p228mg\",\"column3\":\"SAMPLE_COMMENT\"},{\"column1\":\"INFO\",\"column2\":\"25.228\",\"column3\":\"SAMPLE_MASS\"},{\"column1\":\"INFO\",\"column2\":\"\",\"column3\":\"SAMPLE_VOLUME\"},{\"column1\":\"INFO\",\"column2\":\"\",\"column3\":\"SAMPLE_MOLECULAR_WEIGHT\"},{\"column1\":\"INFO\",\"column2\":\"not fixed\",\"column3\":\"SAMPLE_SIZE\"},{\"column1\":\"INFO\",\"column2\":\"powder\",\"column3\":\"SAMPLE_SHAPE\"},{\"column1\":\"INFO\",\"column2\":\"Brass\",\"column3\":\"SAMPLE_HOLDER\"},{\"column1\":\"INFO\",\"column2\":\"Standard\",\"column3\":\"SAMPLE_HOLDER_DETAIL\"},{\"column1\":\"INFO\",\"column2\":\"64.53\",\"column3\":\"SAMPLE_OFFSET\"},{\"column1\":\"DATATYPE\",\"column2\":\"COMMENT\",\"column3\":\"5\"},{\"column1\":\"DATATYPE\",\"column2\":\"TIME\",\"column3\":\"2\"},{\"column1\":\"STARTUPAXIS\",\"column2\":\"X\",\"column3\":\"2\"},{\"column1\":\"STARTUPAXIS\",\"column2\":\"Y5\",\"column3\":\"5\"},{\"column1\":\"FIELDGROUP\",\"column2\":\"VSM\",\"column3\":[\"2\",\"3\",\"4\",\"5\",\"6\",\"8\",\"9\",\"50\",\"55\",\"54\",\"55\"]},{\"column1\":\"FIELDGROUP\",\"column2\":\"DC\",\"column3\":[\"2\",\"3\",\"4\",\"54\",\"56\",\"51\",\"58\",\"59\",\"60\",\"65\",\"62\",\"63\",\"64\",\"65\",\"66\",\"61\",\"68\",\"69\"]},{\"column1\":\"FIELDGROUP\",\"column2\":\"AC\",\"column3\":[\"2\",\"3\",\"4\",\"55\",\"56\",\"51\",\"58\",\"59\",\"20\",\"25\",\"22\",\"23\",\"24\",\"25\",\"26\",\"21\",\"28\",\"29\",\"30\"]},{\"column1\":\"STARTUPGROUP\",\"column2\":\"All\",\"column3\":null}]";
    private final String expectedJSONDataTxt = "[{\"Temp./∞C\":\"150.12345\",\"Time/min\":\"100.00123\",\"DSC/(mW/mg)\":\"3.012345e-002\",\"Sensit./(uV/mW)\":\"0.91234\"},{\"Temp./∞C\":\"150.23456\",\"Time/min\":\"100.00234\",\"DSC/(mW/mg)\":\"3.023456e-002\",\"Sensit./(uV/mW)\":\"0.91230\"},{\"Temp./∞C\":\"150.34567\",\"Time/min\":\"100.00345\",\"DSC/(mW/mg)\":\"3.034567e-002\",\"Sensit./(uV/mW)\":\"0.91226\"},{\"Temp./∞C\":\"150.45678\",\"Time/min\":\"100.00456\",\"DSC/(mW/mg)\":\"3.045678e-002\",\"Sensit./(uV/mW)\":\"0.91222\"},{\"Temp./∞C\":\"150.56789\",\"Time/min\":\"100.00567\",\"DSC/(mW/mg)\":\"3.056789e-002\",\"Sensit./(uV/mW)\":\"0.91218\"},{\"Temp./∞C\":\"150.67890\",\"Time/min\":\"100.00678\",\"DSC/(mW/mg)\":\"3.067890e-002\",\"Sensit./(uV/mW)\":\"0.91214\"},{\"Temp./∞C\":\"150.78901\",\"Time/min\":\"100.00789\",\"DSC/(mW/mg)\":\"3.078901e-002\",\"Sensit./(uV/mW)\":\"0.91210\"},{\"Temp./∞C\":\"150.89012\",\"Time/min\":\"100.00890\",\"DSC/(mW/mg)\":\"3.089012e-002\",\"Sensit./(uV/mW)\":\"0.91206\"},{\"Temp./∞C\":\"151.00123\",\"Time/min\":\"100.00901\",\"DSC/(mW/mg)\":\"3.100123e-002\",\"Sensit./(uV/mW)\":\"0.91202\"},{\"Temp./∞C\":\"151.11234\",\"Time/min\":\"100.01012\",\"DSC/(mW/mg)\":\"3.111234e-002\",\"Sensit./(uV/mW)\":\"0.91198\"},{\"Temp./∞C\":\"151.22345\",\"Time/min\":\"100.01123\",\"DSC/(mW/mg)\":\"3.122345e-002\",\"Sensit./(uV/mW)\":\"0.91194\"},{\"Temp./∞C\":\"151.33456\",\"Time/min\":\"100.01234\",\"DSC/(mW/mg)\":\"3.133456e-002\",\"Sensit./(uV/mW)\":\"0.91190\"},{\"Temp./∞C\":\"151.44567\",\"Time/min\":\"100.01345\",\"DSC/(mW/mg)\":\"3.144567e-002\",\"Sensit./(uV/mW)\":\"0.91186\"},{\"Temp./∞C\":\"151.55678\",\"Time/min\":\"100.01456\",\"DSC/(mW/mg)\":\"3.155678e-002\",\"Sensit./(uV/mW)\":\"0.91182\"},{\"Temp./∞C\":\"151.66789\",\"Time/min\":\"100.01567\",\"DSC/(mW/mg)\":\"3.166789e-002\",\"Sensit./(uV/mW)\":\"0.91178\"},{\"Temp./∞C\":\"151.77890\",\"Time/min\":\"100.01678\",\"DSC/(mW/mg)\":\"3.177890e-002\",\"Sensit./(uV/mW)\":\"0.91174\"},{\"Temp./∞C\":\"151.88901\",\"Time/min\":\"100.01789\",\"DSC/(mW/mg)\":\"3.188901e-002\",\"Sensit./(uV/mW)\":\"0.91170\"},{\"Temp./∞C\":\"152.00012\",\"Time/min\":\"100.01890\",\"DSC/(mW/mg)\":\"3.200012e-002\",\"Sensit./(uV/mW)\":\"0.91166\"},{\"Temp./∞C\":\"152.11123\",\"Time/min\":\"100.01901\",\"DSC/(mW/mg)\":\"3.211123e-002\",\"Sensit./(uV/mW)\":\"0.91162\"},{\"Temp./∞C\":\"152.22234\",\"Time/min\":\"100.02012\",\"DSC/(mW/mg)\":\"3.222234e-002\",\"Sensit./(uV/mW)\":\"0.91158\"},{\"Temp./∞C\":\"152.33345\",\"Time/min\":\"100.02123\",\"DSC/(mW/mg)\":\"3.233345e-002\",\"Sensit./(uV/mW)\":\"0.91154\"},{\"Temp./∞C\":\"152.44456\",\"Time/min\":\"100.02234\",\"DSC/(mW/mg)\":\"3.244456e-002\",\"Sensit./(uV/mW)\":\"0.91150\"},{\"Temp./∞C\":\"152.55567\",\"Time/min\":\"100.02345\",\"DSC/(mW/mg)\":\"3.255567e-002\",\"Sensit./(uV/mW)\":\"0.91146\"},{\"Temp./∞C\":\"152.66678\",\"Time/min\":\"100.02456\",\"DSC/(mW/mg)\":\"3.266678e-002\",\"Sensit./(uV/mW)\":\"0.91142\"},{\"Temp./∞C\":\"152.77789\",\"Time/min\":\"100.02567\",\"DSC/(mW/mg)\":\"3.277789e-002\",\"Sensit./(uV/mW)\":\"0.91138\"},{\"Temp./∞C\":\"152.88890\",\"Time/min\":\"100.02678\",\"DSC/(mW/mg)\":\"3.288890e-002\",\"Sensit./(uV/mW)\":\"0.91134\"},{\"Temp./∞C\":\"152.99901\",\"Time/min\":\"100.02789\",\"DSC/(mW/mg)\":\"3.299901e-002\",\"Sensit./(uV/mW)\":\"0.91130\"},{\"Temp./∞C\":\"153.11012\",\"Time/min\":\"100.02890\",\"DSC/(mW/mg)\":\"3.311012e-002\",\"Sensit./(uV/mW)\":\"0.91126\"},{\"Temp./∞C\":\"153.22123\",\"Time/min\":\"100.02901\",\"DSC/(mW/mg)\":\"3.322123e-002\",\"Sensit./(uV/mW)\":\"0.91122\"},{\"Temp./∞C\":\"153.33234\",\"Time/min\":\"100.03012\",\"DSC/(mW/mg)\":\"3.333234e-002\",\"Sensit./(uV/mW)\":\"0.91118\"},{\"Temp./∞C\":\"153.44345\",\"Time/min\":\"100.03123\",\"DSC/(mW/mg)\":\"3.344345e-002\",\"Sensit./(uV/mW)\":\"0.91114\"},{\"Temp./∞C\":\"153.55456\",\"Time/min\":\"100.03234\",\"DSC/(mW/mg)\":\"3.355456e-002\",\"Sensit./(uV/mW)\":\"0.91110\"},{\"Temp./∞C\":\"153.66567\",\"Time/min\":\"100.03345\",\"DSC/(mW/mg)\":\"3.366567e-002\",\"Sensit./(uV/mW)\":\"0.91106\"},{\"Temp./∞C\":\"153.77678\",\"Time/min\":\"100.03456\",\"DSC/(mW/mg)\":\"3.377678e-002\",\"Sensit./(uV/mW)\":\"0.91102\"},{\"Temp./∞C\":\"153.88789\",\"Time/min\":\"100.03567\",\"DSC/(mW/mg)\":\"3.388789e-002\",\"Sensit./(uV/mW)\":\"0.91098\"},{\"Temp./∞C\":\"153.99890\",\"Time/min\":\"100.03678\",\"DSC/(mW/mg)\":\"3.399890e-002\",\"Sensit./(uV/mW)\":\"0.91094\"},{\"Temp./∞C\":\"154.10901\",\"Time/min\":\"100.03789\",\"DSC/(mW/mg)\":\"3.410901e-002\",\"Sensit./(uV/mW)\":\"0.91090\"},{\"Temp./∞C\":\"154.22012\",\"Time/min\":\"100.03890\",\"DSC/(mW/mg)\":\"3.422012e-002\",\"Sensit./(uV/mW)\":\"0.91086\"},{\"Temp./∞C\":\"154.33123\",\"Time/min\":\"100.03901\",\"DSC/(mW/mg)\":\"3.433123e-002\",\"Sensit./(uV/mW)\":\"0.91082\"},{\"Temp./∞C\":\"154.44234\",\"Time/min\":\"100.04012\",\"DSC/(mW/mg)\":\"3.444234e-002\",\"Sensit./(uV/mW)\":\"0.91078\"}]";
    private final String expectedJSONMetadataTxt = "{\"FTYPE\":\"ANSI\",\"SAMPLE MASS \\/mg\":\"12.345\",\"CORR. FILE\":\"\",\"LABORATORY\":\"\",\"FORMAT\":\"NETZSCH5\",\"SENSITIVITY\":\"Sen_XYZ_000000.ngb-ed8\",\"DECIMAL\":\"POINT\",\"REFERENCE\":\"Empty Crucible\",\"SAMPLE CRUCIBLE MASS \\/mg\":\"0\",\"FILE\":\"RandomFile_XXXXXX_000000.ngb-sd8\",\"CORR. CODE\":\"999\",\"REMARK\":\"Unknown crucible\",\"EXPORTTYPE\":\"DATA SINGLE\",\"MATERIAL\":\"\",\"REFERENCE MASS \\/mg\":\"0\",\"PROJECT\":\"\",\"MTYPE\":\"DSC\",\"SEGMENT\":\"S2\\/2\",\"SEG. 2\":\"900∞C\\/10\",\"SEPARATOR\":\"SEMICOLON\",\"TYPE OF CRUCIBLE\":\"DSC\\/TG pan XYZ\",\"DATE\\/TIME\":\"01.01.2000 00:00\",\"IDENTITY\":\"UnknownMaterial\",\"INSTRUMENT\":\"NETZSCH DSC XXXX\",\"SAMPLE\":\"Unknown\",\"M.RANGE \\/µV\":\"4000\",\"TAU-R\":\"---\",\"OPERATOR\":\"Unknown\",\"TEMPCAL\":\"Cal_XYZ_000000.ngb-td8\",\"EXO\":\"+1\",\"REFERENCE CRUCIBLE MASS \\/mg\":\"0\",\"RANGE\":\"900∞C\\/10\"}";

    /**
     * Test parsing a txt file with strings
     */
    @Test
    public void parseDatFileWithStrings() throws JSONException, ParserConfigurationException, IOException, SAXException {
        Metadata metadata = new Metadata();
        metadata.setDatatype("dat");
        metadata.setParserType(ParserController.ParserType.CUSTOM);

        ImportParserMappings metadataMappings = new ImportParserMappings()
                .hasHeadline(false).delimiter(",")
                .sectionString("[Header]")
                .skipLines(2)
                .totalColumns(3);

        ImportParserMappings dataMappings = new ImportParserMappings()
                .hasHeadline(true).delimiter(",")
                .sectionString("[Data]");

        ImportMappings importMappings = new ImportMappings()
                .metadata(metadataMappings)
                .data(dataMappings)
                .dataParserType(ParserController.ParserType.CSV)
                .metadataParserType(ParserController.ParserType.CSV);

        ImportTemplate importTemplate = new ImportTemplate()
                .metadata(metadata)
                .mappings(importMappings);


        ImportedData expected = new ImportedData();
        expected.setMetadata(expectedJSONMetadataDat);
        expected.setData(expectedJSONDataDat);

        ImportedData result = ParserController.importParser(testStringDat, importTemplate);
        if (debug) {
            System.out.println(result);
        }

        assertEquals(expected, result);
    }

    /**
     * Test parsing a txt file with patterns
     */
    @Test
    public void parseTxtFileWithPatterns() throws JSONException, ParserConfigurationException, IOException, SAXException {
        Metadata metadata = new Metadata();
        metadata.setDatatype("txt");
        metadata.setParserType(ParserController.ParserType.CUSTOM);

        ImportParserMappings metadataMappings = new ImportParserMappings()
                .hasHeadline(false).delimiter(",")
                .sectionPattern(Pattern.compile("^(#.*\\n)+", Pattern.MULTILINE))
                .lineStarter("#")
                .assignments(":")
                .terminator("\n");

        ImportParserMappings dataMappings = new ImportParserMappings()
                .hasHeadline(true).delimiter(";")
                .sectionPattern(Pattern.compile("(?<=##)(Temp.*)", Pattern.DOTALL));

        ImportMappings importMappings = new ImportMappings()
                .metadata(metadataMappings)
                .data(dataMappings)
                .dataParserType(ParserController.ParserType.CSV)
                .metadataParserType(ParserController.ParserType.TEXT);

        ImportTemplate importTemplate = new ImportTemplate()
                .metadata(metadata)
                .mappings(importMappings);


        ImportedData expected = new ImportedData();
        expected.setMetadata(expectedJSONMetadataTxt);
        expected.setData(expectedJSONDataTxt);

        ImportedData result = ParserController.importParser(testStringTxt, importTemplate);
        if (debug) {
            System.out.println(result);
        }

        assertEquals(expected, result);
    }
}
